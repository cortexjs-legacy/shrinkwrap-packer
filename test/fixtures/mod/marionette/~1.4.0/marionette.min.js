define("marionette@~1.4.0",["backbone@~1.1.0","underscore@~1.5.0"],function(a,b,c){var d=a("backbone"),e=a("underscore");d.ChildViewContainer=function(a,b){var c=function(a){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),b.each(a,this.add,this)};b.extend(c.prototype,{add:function(a,b){var c=a.cid;this._views[c]=a,a.model&&(this._indexByModel[a.model.cid]=c),b&&(this._indexByCustom[b]=c),this._updateLength()},findByModel:function(a){return this.findByModelCid(a.cid)},findByModelCid:function(a){var b=this._indexByModel[a];return this.findByCid(b)},findByCustom:function(a){var b=this._indexByCustom[a];return this.findByCid(b)},findByIndex:function(a){return b.values(this._views)[a]},findByCid:function(a){return this._views[a]},remove:function(a){var c=a.cid;a.model&&delete this._indexByModel[a.model.cid],b.any(this._indexByCustom,function(a,b){return a===c?(delete this._indexByCustom[b],!0):void 0},this),delete this._views[c],this._updateLength()},call:function(a){this.apply(a,b.tail(arguments))},apply:function(a,c){b.each(this._views,function(d){b.isFunction(d[a])&&d[a].apply(d,c||[])})},_updateLength:function(){this.length=b.size(this._views)}});var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return b.each(d,function(a){c.prototype[a]=function(){var c=b.values(this._views),d=[c].concat(b.toArray(arguments));return b[a].apply(b,d)}}),c}(d,e),d.Wreqr=function(a,b,c){"use strict";var d={};return d.Handlers=function(a,b){var c=function(a){this.options=a,this._wreqrHandlers={},b.isFunction(this.initialize)&&this.initialize(a)};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events,{setHandlers:function(a){b.each(a,function(a,c){var d=null;b.isObject(a)&&!b.isFunction(a)&&(d=a.context,a=a.callback),this.setHandler(c,a,d)},this)},setHandler:function(a,b,c){var d={callback:b,context:c};this._wreqrHandlers[a]=d,this.trigger("handler:add",a,b,c)},hasHandler:function(a){return!!this._wreqrHandlers[a]},getHandler:function(a){var b=this._wreqrHandlers[a];if(!b)throw new Error("Handler not found for '"+a+"'");return function(){var a=Array.prototype.slice.apply(arguments);return b.callback.apply(b.context,a)}},removeHandler:function(a){delete this._wreqrHandlers[a]},removeAllHandlers:function(){this._wreqrHandlers={}}}),c}(a,c),d.CommandStorage=function(){var b=function(a){this.options=a,this._commands={},c.isFunction(this.initialize)&&this.initialize(a)};return c.extend(b.prototype,a.Events,{getCommands:function(a){var b=this._commands[a];return b||(b={command:a,instances:[]},this._commands[a]=b),b},addCommand:function(a,b){var c=this.getCommands(a);c.instances.push(b)},clearCommands:function(a){var b=this.getCommands(a);b.instances=[]}}),b}(),d.Commands=function(a){return a.Handlers.extend({storageType:a.CommandStorage,constructor:function(b){this.options=b||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var c=Array.prototype.slice.call(arguments);a.Handlers.prototype.constructor.apply(this,c)},execute:function(a,b){a=arguments[0],b=Array.prototype.slice.call(arguments,1),this.hasHandler(a)?this.getHandler(a).apply(this,b):this.storage.addCommand(a,b)},_executeCommands:function(a,b,d){var e=this.storage.getCommands(a);c.each(e.instances,function(a){b.apply(d,a)}),this.storage.clearCommands(a)},_initializeStorage:function(a){var b,d=a.storageType||this.storageType;b=c.isFunction(d)?new d:d,this.storage=b}})}(d),d.RequestResponse=function(a){return a.Handlers.extend({request:function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);return this.getHandler(a).apply(this,b)}})}(d),d.EventAggregator=function(a,b){var c=function(){};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events),c}(a,c),d}(d,d.Marionette,e);!function(a,b,d){"use strict";function e(a){return h.call(a)}function f(a,b){var c=new Error(a);throw c.name=b||"Error",c}var g={};b.Marionette=g,g.$=b.$;var h=Array.prototype.slice;g.extend=b.Model.extend,g.getOption=function(a,b){if(a&&b){var c;return c=a.options&&b in a.options&&void 0!==a.options[b]?a.options[b]:a[b]}},g.triggerMethod=function(){function a(a,b,c){return c.toUpperCase()}var b=/(^|:)(\w)/gi,c=function(c){var e="on"+c.replace(b,a),f=this[e];return d.isFunction(this.trigger)&&this.trigger.apply(this,arguments),d.isFunction(f)?f.apply(this,d.tail(arguments)):void 0};return c}(),g.MonitorDOMRefresh=function(){function a(a){a._isShown=!0,c(a)}function b(a){a._isRendered=!0,c(a)}function c(a){a._isShown&&a._isRendered&&d.isFunction(a.triggerMethod)&&a.triggerMethod("dom:refresh")}return function(c){c.listenTo(c,"show",function(){a(c)}),c.listenTo(c,"render",function(){b(c)})}}(),function(a){function b(a,b,c,e){var g=e.split(/\s+/);d.each(g,function(d){var e=a[d];e||f("Method '"+d+"' was configured as an event handler, but does not exist."),a.listenTo(b,c,e,a)})}function c(a,b,c,d){a.listenTo(b,c,d,a)}function e(a,b,c,e){var f=e.split(/\s+/);d.each(f,function(d){var e=a[d];a.stopListening(b,c,e,a)})}function g(a,b,c,d){a.stopListening(b,c,d,a)}function h(a,b,c,e,f){b&&c&&(d.isFunction(c)&&(c=c.call(a)),d.each(c,function(c,g){d.isFunction(c)?e(a,b,g,c):f(a,b,g,c)}))}a.bindEntityEvents=function(a,d,e){h(a,d,e,c,b)},a.unbindEntityEvents=function(a,b,c){h(a,b,c,g,e)}}(g),g.Callbacks=function(){this._deferred=g.$.Deferred(),this._callbacks=[]},d.extend(g.Callbacks.prototype,{add:function(a,b){this._callbacks.push({cb:a,ctx:b}),this._deferred.done(function(c,d){b&&(c=b),a.call(c,d)})},run:function(a,b){this._deferred.resolve(b,a)},reset:function(){var a=this._callbacks;this._deferred=g.$.Deferred(),this._callbacks=[],d.each(a,function(a){this.add(a.cb,a.ctx)},this)}}),g.Controller=function(a){this.triggerMethod=g.triggerMethod,this.options=a||{},d.isFunction(this.initialize)&&this.initialize(this.options)},g.Controller.extend=g.extend,d.extend(g.Controller.prototype,b.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),g.Region=function(a){if(this.options=a||{},this.el=g.getOption(this,"el"),!this.el){var b=new Error("An 'el' must be specified for a region.");throw b.name="NoElError",b}if(this.initialize){var c=Array.prototype.slice.apply(arguments);this.initialize.apply(this,c)}},d.extend(g.Region,{buildRegion:function(a,b){var c="string"==typeof a,e="string"==typeof a.selector,f="undefined"==typeof a.regionType,g="function"==typeof a;if(!g&&!c&&!e)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var h,i;c&&(h=a),a.selector&&(h=a.selector),g&&(i=a),!g&&f&&(i=b),a.regionType&&(i=a.regionType);var j=new i({el:h});return a.parentEl&&(j.getEl=function(b){var c=a.parentEl;return d.isFunction(c)&&(c=c()),c.find(b)}),j}}),d.extend(g.Region.prototype,b.Events,{show:function(a){this.ensureEl();var b=a.isClosed||d.isUndefined(a.$el),c=a!==this.currentView;c&&this.close(),a.render(),(c||b)&&this.open(a),this.currentView=a,g.triggerMethod.call(this,"show",a),g.triggerMethod.call(a,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(a){return g.$(a)},open:function(a){this.$el.empty().append(a.el)},close:function(){var a=this.currentView;a&&!a.isClosed&&(a.close?a.close():a.remove&&a.remove(),g.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(a){this.currentView=a},reset:function(){this.close(),delete this.$el}}),g.Region.extend=g.extend,g.RegionManager=function(a){var b=a.Controller.extend({constructor:function(b){this._regions={},a.Controller.prototype.constructor.call(this,b)},addRegions:function(a,b){var c={};return d.each(a,function(a,e){"string"==typeof a&&(a={selector:a}),a.selector&&(a=d.defaults({},a,b));var f=this.addRegion(e,a);c[e]=f},this),c},addRegion:function(b,c){var e,f=d.isObject(c),g=d.isString(c),h=!!c.selector;return e=g||f&&h?a.Region.buildRegion(c,a.Region):d.isFunction(c)?a.Region.buildRegion(c,a.Region):c,this._store(b,e),this.triggerMethod("region:add",b,e),e},get:function(a){return this._regions[a]},removeRegion:function(a){var b=this._regions[a];this._remove(a,b)},removeRegions:function(){d.each(this._regions,function(a,b){this._remove(b,a)},this)},closeRegions:function(){d.each(this._regions,function(a){a.close()},this)},close:function(){this.removeRegions();var b=Array.prototype.slice.call(arguments);a.Controller.prototype.close.apply(this,b)},_store:function(a,b){this._regions[a]=b,this._setLength()},_remove:function(a,b){b.close(),delete this._regions[a],this._setLength(),this.triggerMethod("region:remove",a,b)},_setLength:function(){this.length=d.size(this._regions)}}),c=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return d.each(c,function(a){b.prototype[a]=function(){var b=d.values(this._regions),c=[b].concat(d.toArray(arguments));return d[a].apply(d,c)}}),b}(g),g.TemplateCache=function(a){this.templateId=a},d.extend(g.TemplateCache,{templateCaches:{},get:function(a){var b=this.templateCaches[a];return b||(b=new g.TemplateCache(a),this.templateCaches[a]=b),b.load()},clear:function(){var a,b=e(arguments),c=b.length;if(c>0)for(a=0;c>a;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}}),d.extend(g.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var a=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(a),this.compiledTemplate},loadTemplate:function(a){var b=g.$(a).html();return b&&0!==b.length||f("Could not find template: '"+a+"'","NoTemplateError"),b},compileTemplate:function(a){return d.template(a)}}),g.Renderer={render:function(a,b){if(!a){var c=new Error("Cannot render the template since it's false, null or undefined.");throw c.name="TemplateNotFoundError",c}var d;return d="function"==typeof a?a:g.TemplateCache.get(a),d(b)}},g.View=b.View.extend({constructor:function(a){d.bindAll(this,"render");var c=Array.prototype.slice.apply(arguments);this.options=d.extend({},this.options,a),this.events=this.normalizeUIKeys(d.result(this,"events")),b.View.prototype.constructor.apply(this,c),g.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:g.triggerMethod,getTemplate:function(){return g.getOption(this,"template")},mixinTemplateHelpers:function(a){a=a||{};var b=g.getOption(this,"templateHelpers");return d.isFunction(b)&&(b=b.call(this)),d.extend(a,b)},normalizeUIKeys:function(a){return"undefined"!=typeof a?(d.each(d.keys(a),function(b){var c=b.split("@ui.");2===c.length&&(a[c[0]+this.ui[c[1]]]=a[b],delete a[b])},this),a):void 0},configureTriggers:function(){if(this.triggers){var a={},b=this.normalizeUIKeys(d.result(this,"triggers"));return d.each(b,function(b,c){var e=d.isObject(b),f=e?b.event:b;a[c]=function(a){if(a){var c=a.preventDefault,d=a.stopPropagation,g=e?b.preventDefault:c,h=e?b.stopPropagation:d;g&&c&&c.apply(a),h&&d&&d.apply(a)}var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(f,i)}},this),a}},delegateEvents:function(a){this._delegateDOMEvents(a),g.bindEntityEvents(this,this.model,g.getOption(this,"modelEvents")),g.bindEntityEvents(this,this.collection,g.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(a){a=a||this.events,d.isFunction(a)&&(a=a.call(this));var c={},e=this.configureTriggers();d.extend(c,a,e),b.View.prototype.delegateEvents.call(this,c)},undelegateEvents:function(){var a=Array.prototype.slice.call(arguments);b.View.prototype.undelegateEvents.apply(this,a),g.unbindEntityEvents(this,this.model,g.getOption(this,"modelEvents")),g.unbindEntityEvents(this,this.collection,g.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var a=this.triggerMethod("before:close");a!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var a=d.result(this,"_uiBindings");this.ui={},d.each(d.keys(a),function(b){var c=a[b];this.ui[b]=this.$(c)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(d.each(this.ui,function(a,b){delete this.ui[b]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),g.ItemView=g.View.extend({constructor:function(){g.View.prototype.constructor.apply(this,e(arguments))},serializeData:function(){var a={};return this.model?a=this.model.toJSON():this.collection&&(a={items:this.collection.toJSON()}),a},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var a=this.serializeData();a=this.mixinTemplateHelpers(a);var b=this.getTemplate(),c=g.Renderer.render(b,a);return this.$el.html(c),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),g.View.prototype.close.apply(this,e(arguments)),this.triggerMethod("item:closed"))}}),g.CollectionView=g.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),g.View.prototype.constructor.apply(this,e(arguments)),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment()},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.appendBuffer(this,this.elBuffer),this.initRenderBuffer(),this.isBuffering=!1},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(a){this.closeEmptyView();var b=this.getItemView(a),c=this.collection.indexOf(a);this.addItemView(a,b,c)},onShowCalled:function(){this.children.each(function(a){g.triggerMethod.call(a,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView(),this.endBuffering()},showCollection:function(){var a;this.collection.each(function(b,c){a=this.getItemView(b),this.addItemView(b,a,c)},this)},showEmptyView:function(){var a=this.getEmptyView();if(a&&!this._showingEmptyView){this._showingEmptyView=!0;var c=new b.Model;this.addItemView(c,a,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return g.getOption(this,"emptyView")},getItemView:function(){var a=g.getOption(this,"itemView");return a||f("An `itemView` must be specified","NoItemViewError"),a},addItemView:function(a,b,c){var e=g.getOption(this,"itemViewOptions");d.isFunction(e)&&(e=e.call(this,a,c));var f=this.buildItemView(a,b,e);this.addChildViewEventForwarding(f),this.triggerMethod("before:item:added",f),this.children.add(f),this.renderItemView(f,c),this._isShown&&g.triggerMethod.call(f,"show"),this.triggerMethod("after:item:added",f)},addChildViewEventForwarding:function(a){var b=g.getOption(this,"itemViewEventPrefix");this.listenTo(a,"all",function(){var c=e(arguments);c[0]=b+":"+c[0],c.splice(1,0,a),g.triggerMethod.apply(this,c)},this)},renderItemView:function(a,b){a.render(),this.appendHtml(this,a,b)},buildItemView:function(a,b,c){var e=d.extend({model:a},c);return new b(e)},removeItemView:function(a){var b=this.children.findByModel(a);this.removeChildView(b),this.checkEmpty()},removeChildView:function(a){a&&(this.stopListening(a),a.close?a.close():a.remove&&a.remove(),this.children.remove(a)),this.triggerMethod("item:removed",a)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendBuffer:function(a,b){a.$el.append(b)},appendHtml:function(a,b){a.isBuffering?a.elBuffer.appendChild(b.el):a.$el.append(b.el)},_initChildViewStorage:function(){this.children=new b.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),g.View.prototype.close.apply(this,e(arguments)))},closeChildren:function(){this.children.each(function(a){this.removeChildView(a)},this),this.checkEmpty()}}),g.CompositeView=g.CollectionView.extend({constructor:function(){g.CollectionView.prototype.constructor.apply(this,e(arguments))},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))})},getItemView:function(){var a=g.getOption(this,"itemView")||this.constructor;return a||f("An `itemView` must be specified","NoItemViewError"),a},serializeData:function(){var a={};return this.model&&(a=this.model.toJSON()),a},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var a=this.renderModel();return this.$el.html(a),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(g.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var a={};a=this.serializeData(),a=this.mixinTemplateHelpers(a);var b=this.getTemplate();return g.Renderer.render(b,a)},appendBuffer:function(a,b){var c=this.getItemViewContainer(a);c.append(b)},appendHtml:function(a,b){if(a.isBuffering)a.elBuffer.appendChild(b.el);else{var c=this.getItemViewContainer(a);c.append(b.el)}},getItemViewContainer:function(a){if("$itemViewContainer"in a)return a.$itemViewContainer;var b,c=g.getOption(a,"itemViewContainer");if(c){var e=d.isFunction(c)?c():c;b=a.$(e),b.length<=0&&f("The specified `itemViewContainer` was not found: "+a.itemViewContainer,"ItemViewContainerMissingError")}else b=a.$el;return a.$itemViewContainer=b,b},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),g.Layout=g.ItemView.extend({regionType:g.Region,constructor:function(a){a=a||{},this._firstRender=!0,this._initializeRegions(a),g.ItemView.prototype.constructor.call(this,a)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var a=Array.prototype.slice.apply(arguments),b=g.ItemView.prototype.render.apply(this,a);return b},close:function(){if(!this.isClosed){this.regionManager.close();var a=Array.prototype.slice.apply(arguments);g.ItemView.prototype.close.apply(this,a)}},addRegion:function(a,b){var c={};return c[a]=b,this._buildRegions(c)[a]},addRegions:function(a){return this.regions=d.extend({},this.regions,a),this._buildRegions(a)},removeRegion:function(a){return delete this.regions[a],this.regionManager.removeRegion(a)},_buildRegions:function(a){var b=this,c={regionType:g.getOption(this,"regionType"),parentEl:function(){return b.$el}};return this.regionManager.addRegions(a,c)},_initializeRegions:function(a){var b;this._initRegionManager(),b=d.isFunction(this.regions)?this.regions(a):this.regions||{},this.addRegions(b)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(a){a.reset()})},_initRegionManager:function(){this.regionManager=new g.RegionManager,this.listenTo(this.regionManager,"region:add",function(a,b){this[a]=b,this.trigger("region:add",a,b)}),this.listenTo(this.regionManager,"region:remove",function(a,b){delete this[a],this.trigger("region:remove",a,b)})}}),g.AppRouter=b.Router.extend({constructor:function(a){b.Router.prototype.constructor.apply(this,e(arguments)),this.options=a||{};var c=g.getOption(this,"appRoutes"),d=this._getController();this.processAppRoutes(d,c)},appRoute:function(a,b){var c=this._getController();this._addAppRoute(c,a,b)},processAppRoutes:function(a,b){if(b){var c=d.keys(b).reverse();d.each(c,function(c){this._addAppRoute(a,c,b[c])},this)}},_getController:function(){return g.getOption(this,"controller")},_addAppRoute:function(a,b,c){var e=a[c];if(!e)throw new Error("Method '"+c+"' was not found on the controller");this.route(b,c,d.bind(e,a))}}),g.Application=function(a){this._initRegionManager(),this._initCallbacks=new g.Callbacks,this.vent=new b.Wreqr.EventAggregator,this.commands=new b.Wreqr.Commands,this.reqres=new b.Wreqr.RequestResponse,this.submodules={},d.extend(this,a),this.triggerMethod=g.triggerMethod},d.extend(g.Application.prototype,b.Events,{execute:function(){var a=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,a)},request:function(){var a=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,a)},addInitializer:function(a){this._initCallbacks.add(a)},start:function(a){this.triggerMethod("initialize:before",a),this._initCallbacks.run(a,this),this.triggerMethod("initialize:after",a),this.triggerMethod("start",a)},addRegions:function(a){return this._regionManager.addRegions(a)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(a){this._regionManager.removeRegion(a)},getRegion:function(a){return this._regionManager.get(a)},module:function(){var a=e(arguments);return a.unshift(this),g.Module.create.apply(g.Module,a)},_initRegionManager:function(){this._regionManager=new g.RegionManager,this.listenTo(this._regionManager,"region:add",function(a,b){this[a]=b}),this.listenTo(this._regionManager,"region:remove",function(a){delete this[a]})}}),g.Application.extend=g.extend,g.Module=function(a,b){this.moduleName=a,this.submodules={},this._setupInitializersAndFinalizers(),this.app=b,this.startWithParent=!0,this.triggerMethod=g.triggerMethod},d.extend(g.Module.prototype,b.Events,{addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){this._isInitialized||(d.each(this.submodules,function(b){b.startWithParent&&b.start(a)}),this.triggerMethod("before:start",a),this._initializerCallbacks.run(a,this),this._isInitialized=!0,this.triggerMethod("start",a))},stop:function(){this._isInitialized&&(this._isInitialized=!1,g.triggerMethod.call(this,"before:stop"),d.each(this.submodules,function(a){a.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),g.triggerMethod.call(this,"stop"))},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,c){if(a){var e=d.flatten([this,this.app,b,g,g.$,d,c]);a.apply(this,e)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new g.Callbacks,this._finalizerCallbacks=new g.Callbacks}}),d.extend(g.Module,{create:function(a,b,c){var f=a,g=e(arguments);g.splice(0,3),b=b.split(".");var h=b.length,i=[];return i[h-1]=c,d.each(b,function(b,c){var d=f;f=this._getModule(d,b,a),this._addModuleDefinition(d,f,i[c],g)},this),f},_getModule:function(a,b,c){var d=a[b];return d||(d=new g.Module(b,c),a[b]=d,a.submodules[b]=d),d},_addModuleDefinition:function(a,b,c,e){var f,g;d.isFunction(c)?(f=c,g=!0):d.isObject(c)?(f=c.define,g=c.startWithParent):g=!0,f&&b.addDefinition(f,e),b.startWithParent=b.startWithParent&&g,b.startWithParent&&!b.startWithParentIsConfigured&&(b.startWithParentIsConfigured=!0,a.addInitializer(function(a){b.startWithParent&&b.start(a)}))}}),c.exports=g}(this,d,e)});