define("unit-m-weixin@1.12.7/js/modules/refund/button/template.html",[],function(e,t,i){i.exports='<div class="refund-btn J_buy"><%if(submiting){%><a href="javascript:void(0)" class="n-btn">正在处理</a><%}else{%><a href="javascript:void(0)" class="y-btn J_submit" style="">确认退款</a><%}%></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/base/share",["wepp@~2.7.0","underscore@~1.5.0","zepto-wepp@~1.1.0"],function(e,t,i){function n(){var e=a.link.match(/\?([^#$]*)/),t={};e&&(t=s.parse(e[1])),t.utm="wxshare";var i=a.link.replace(/(\?[^#$]*)/,"");a.link=i.replace(/((:?#[\w\W]*)|$)/,function(e,i){return"?"+s.stringify(t)+i}),console.log(a.link)}function o(){l||window.WeixinJSBridge&&(l=!0,WeixinJSBridge.on("menu:share:appmessage",function(){r&&(n(),WeixinJSBridge.invoke("sendAppMessage",a,function(){}))}),WeixinJSBridge.on("menu:share:timeline",function(){if(r){n();var e=c.clone(a);e.title=e.timelineTitle||e.title,WeixinJSBridge.invoke("shareTimeline",e,function(){})}}),e("zepto-wepp").os.ios&&WeixinJSBridge.call("hideToolbar"))}var s=e("wepp").Url,a={appid:"wx841a97238d9e17b2",img_url:"",img_width:"640",img_height:"640",link:"",desc:"",title:"",timelineTitle:""},c=e("underscore"),r=!1,l=!1;o(),document.addEventListener("WeixinJSBridgeReady",o,!1),i.exports={config:function(e){a=c.extend(a,e)},enable:function(e){r=e;try{l?WeixinJSBridge.call(r?"showOptionMenu":"hideOptionMenu"):r?document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.call("showOptionMenu")},!1):document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.call("hideOptionMenu")},!1)}catch(t){}},linkPre:n,__config__:a}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/footmenu/controller",["marionette@~1.4.0","wepp@~2.7.0","./template.html","zepto-wepp@~1.1.0","../overlay","underscore@~1.5.0"],function(e,t,i){var n=e("marionette"),o=e("wepp").Module.BaseView(e("./template.html")),s=e("zepto-wepp"),a=e("../overlay"),c=e("wepp").Module.City,r=e("underscore"),l="food_bubble",d=n.Controller.extend({initialize:function(){this.view=new o,this.view.render(),localStorage.getItem(l)||this.view.$el.find(".noti").removeClass("hide"),this.setCity(),s("body").append(this.view.$el.hide()),this.menus=this.view.$el.find(".menu-banner a"),this.more=this.view.$el.find(".more-banner"),this.overlay=new a,this.currentIndex=-1,this.tempCloseMore=!1,this.events()},show:function(e){return this.tempCloseMore&&!e&&(this.tempCloseMore=!1,this.showMore()),this.view.$el.show(),this},hide:function(){return this.view.$el.hide(),this},switchTo:function(e,t,i){return e!==this.currentIndex||i?(t!==!1&&(this.currentIndex=e),this.menus.removeClass("on").eq(e).addClass("on"),0===e&&(localStorage.setItem(l,!0),this.view.$el.find(".noti").addClass("hide")),this):void 0},events:function(){var e=this,t=this.menus;t.each(function(i,n){i!=t.length-1&&s(n).on("click",function(){e.hideMore(),e.switchTo(i)})}),t.eq(t.length-1).on("click",r.bind(e.toggleMore,e)),this.more.find("a").on("click",function(){e.tempCloseMore=!0,e.hideMore()}),this.overlay.on("hide",function(){e.switchTo(e.currentIndex,!0,!0),e.more.hide()}),c.on("change",r.bind(e.setCity,e))},showMore:function(){this.switchTo(2,!1),this.more.show(),this.overlay.show(),this._more_show=!0},hideMore:function(){this.overlay.hide(),this._more_show=!1},toggleMore:function(){this._more_show?this.hideMore():this.showMore()},setCity:function(){this.view.$el.find(".J_c_city").html(c.getName())},setUrl:function(e,t){this.menus.eq(e).attr("href",t)}});i.exports=d},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/util/geolocation",["backbone@~1.1.0","zepto-wepp@~1.1.0","underscore@~1.5.0","cookie@~0.1.0"],function(e,t,i){var n,o=(e("backbone"),e("zepto-wepp")),s=e("underscore"),a=e("cookie"),c=.5/60/24,r="lng",l="lat",d=function(){return a(r)?{lat:a(l),lng:a(r)}:null},p=function(e,t,i){a("lng",t,{expires:c}),a("lat",e,{expires:c}),a("geocityid",i,{expires:c})},u=function(e,t){navigator.geolocation.getCurrentPosition(function(t){var i=t.coords,n=i.longitude,o=i.latitude;e({lng:n,lat:o})},t,{enableHighAccuracy:!0,timeout:3e3,maximumAge:3e3})},h={fetching:!1,get:function(e){function t(t){h.fetching=!1,e?h.getCityByGeo(t,function(e){e?(p(t.lat,t.lng,e.id),n.resolve(s.extend(t,e))):(h.fetching=!1,n.reject())}):(p(t.lat,t.lng),n.resolve(t))}if(h.fetching)return n;h.fetching=!0,n=new o.Deferred;var i;return(i=d())?setTimeout(function(){t(i)},0):u(t,function(){h.fetching=!1,n.reject()}),n},getCityByGeo:function(e,t){o.ajax({url:"/ajax/tuan/cityidgn.json",data:{lat:e.lat,lng:e.lng},dataType:"json",success:function(e){t(200==e.code&&e.data&&e.data.id>0?{cityid:e.data.id,cityname:e.data.name,cityenname:e.data.enName}:null)}})},cookieGeo:d};i.exports=h},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/first",["wepp@~2.7.0"],function(e,t,i){var n=e("wepp").Url;i.exports={firstVisit:function(){return null===localStorage.getItem("cityselect")},firstSelect:function(){return"first"===localStorage.getItem("cityselect")},checkFirst:function(){var e=n.get("cityid");return!e&&this.firstVisit()?(localStorage.setItem("cityrefer",location.hash),ThisApp.redirect("#citylist",!0),!0):!1}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/layout.html",[],function(e,t,i){i.exports='<div class="refund-box"><div class="J_cnt"></div><div class="J_cause"></div><div class="J_button"></div><div class="J_alert"></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/routeconfig",[],function(e,t,i){var n={title:"点评团·放心团",desc:"吃喝玩乐，应有尽有，随时随地，想团就团，快来试试吧！"};i.exports={"":{pv:{pageId:"172001"},share:n,appjs:["./pages/index"],method:"show"},chosen:{appjs:["./pages/chosen"],method:"show",pv:{pageId:"172019"},share:{title:"吃喝玩乐尽在大众点评",desc:"好吃，好玩，还省钱"}},"list(~k_:keyword)(~c_:category)(~r_:region)(~f_:filter)(~lng_:lng)(~lat_:lat)":{pv:{pageId:"172001"},share:n,appjs:["./pages/index"],method:"show"},"detail~:id":{pv:{pageId:"172002"},share:{},appjs:["./pages/detail"],method:"show"},"detailmore~:id":{pv:{pageId:"172003"},appjs:["./pages/detailmore"],method:"show"},"shoplist~:id":{pv:{pageId:"172004"},appjs:["./pages/shoplist"],method:"show"},"order~g_:groupId~d_:dealId":{pv:{pageId:"172006"},appjs:["./pages/pay"],method:"show"},"orderconfirm~:id":{pv:{pageId:"172009"},appjs:["./pages/orderconfirm"],method:"show"},"orderdetail~:id":{pv:{pageId:"172014"},appjs:["./pages/orderdetail"],method:"show"},paypromo:{appjs:["./pages/paypromo"],method:"show"},"promo~:orderid":{pv:{pageId:"172010"},appjs:["./pages/promo"],method:"show"},receiptlist:{pv:{pageId:"172012"},appjs:["./pages/receiptlist"],method:"show",filters:["login"]},"receiptdetail~:id":{pv:{pageId:"172013"},appjs:["./pages/receiptdetail"],method:"show",filters:["login"]},"deliveryadd~:index":{pv:{pageId:"172007"},appjs:["./pages/deliveryadd"],method:"show"},deliverylist:{pv:{pageId:"172008"},appjs:["./pages/deliverylist"],method:"show"},"dealselect~g_:id":{pv:{pageId:"172005"},appjs:["./pages/dealselect"],method:"show"},"paysuc~:id":{pv:{pageId:"172011"},appjs:["./pages/paysuc"],share:n,method:"show"},alertinfo:{appjs:["./pages/alertinfo"],method:"show"},couponlist:{appjs:["./pages/couponlist"],method:"show",pv:{pageId:"172015"},filters:["login"]},my:{appjs:["./pages/my"],method:"show",pv:{pageId:"172016"},filters:["login"]},citylist:{appjs:["./pages/citylist"],method:"show",pv:{pageId:"172017"}},"refund~:id":{appjs:["./pages/refund"],method:"show"},innertest:{appjs:["./pages/test"],method:"show"},orderlist:{appjs:["./pages/orderlist"],method:"show",filters:["login"],pv:{pageId:"172018"}}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/envconfig",["wepp@~2.7.0"],function(e){var t=e("wepp").ENV;t.config("appid",{beta:"wx1613983303fce900",pre:"wx841a97238d9e17b2",online:"wx841a97238d9e17b2"}),t.config("cpsUrl",{beta:"http://tcps.51ping.com",pre:"http://cps.dianping.com",online:"http://cps.dianping.com"}),t.config("mmUrl",{beta:"http://mm.51ping.com",pre:"http://ppe.mm.dianping.com",online:"http://mm.dianping.com"}),t.config("payDomain",{beta:"http://api.p.51ping.com",pre:"http://ppe.api.p.dianping.com",online:"http://api.p.dianping.com"}),t.config("accountDomain",{beta:"http://m.51ping.com",pre:"http://ppe.m.dianping.com",online:"http://m.dianping.com"})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/overlay",["zepto-wepp@~1.1.0","underscore@~1.5.0","backbone@~1.1.0"],function(e,t,i){function n(e){var t=this;this.container=e||"body";var i=this.overlay=c();i.on("touchstart touchmove touchend",function(e){e.preventDefault()}),i.on("touchstart click",function(){t.hide()})}var o=e("zepto-wepp"),s=e("underscore"),a=e("backbone"),c=function(){return o('<div class="overlay" style="z-index:200;"></div>')};n.prototype.show=function(){this.overlay.appendTo(this.container).show(),this.trigger("show")},n.prototype.hide=function(){this.overlay.hide(),this.trigger("hide")},s.extend(n.prototype,a.Events),i.exports=n},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/filters/login",["zepto-wepp@~1.1.0","wepp@~2.7.0"],function(e,t,i){var n=e("zepto-wepp"),o=e("wepp").ENV,s=function(){var e=encodeURIComponent("type=quan,url="+location.href),t="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+o.get("appid")+"&redirect_uri="+o.get("cpsUrl")+"/weiXinRedirect&response_type=code&scope=snsapi_base&state="+e+"#wechat_redirect";location.href=t},a=function(e){n.ajax({url:"/ajax/tuan/tuanprofilegn.json?",type:"POST",dataType:"json",success:function(t){200!==t.code&&e()}})};i.exports={check:function(){var e=n.Deferred();return ThisApp.isLogin?(setTimeout(function(){e.resolve()},0),a(s)):(s(),setTimeout(function(){e.reject()},0)),e.promise()}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/content/view",["marionette@~1.4.0","underscore@~1.5.0","zepto-wepp@~1.1.0","./template.html"],function(e,t,i){var n=e("marionette"),o=e("underscore"),s=e("zepto-wepp");i.exports=n.ItemView.extend({template:o.template(e("./template.html")),className:"div",events:{"click .J_count_add":"addNum","click .J_count_sub":"subNum"},addNum:function(e){e.preventDefault();var t=s(e.target),i=this.model;if(!t.hasClass("J_un")){var n=i.get("selectIndex");i.set("selectIndex",n+1)}},subNum:function(e){e.preventDefault();var t=s(e.target),i=this.model;if(!t.hasClass("J_un")){var n=i.get("selectIndex");i.set("selectIndex",n-1)}}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/alert/controller",["wepp@~2.7.0","./template.html","backbone@~1.1.0","marionette@~1.4.0","underscore@~1.5.0","zepto-wepp@~1.1.0"],function(e,t,i){var n=e("wepp").Module.BaseView(e("./template.html")),o=e("backbone"),s=e("marionette"),a=(e("underscore"),e("zepto-wepp"));i.exports=s.Controller.extend({initialize:function(e){this.view=new n({model:new o.Model(e)}),this.view.render(),this.box=this.view.$el.hide().appendTo("body"),this.box.find(".alert_buttons a").each(function(t,i){e.buttons[t].click&&a(i).on("click",e.buttons[t].click)}),e.buttons&&1===e.buttons.length&&this.box.find(".alert_buttons a").css("width","100%")},show:function(){this.box.show();var e=this.box.find(".confirm_alert");e.css("margin-top",-e.height()/2)},hide:function(){this.box.hide()}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/cause/view",["marionette@~1.4.0","underscore@~1.5.0","zepto-wepp@~1.1.0","./template.html"],function(e,t,i){var n=e("marionette"),o=e("underscore"),s=e("zepto-wepp");i.exports=n.ItemView.extend({template:o.template(e("./template.html")),tagName:"div",events:{"click .J_cause_select":"causeSelect"},causeSelect:function(e){e.preventDefault();var t=s(e.currentTarget),i=this.model;i.set("causeIndex",t.attr("data"))}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/util/cache",[],function(e,t,i){function n(e){return e in s?s[e]:null}function o(e){return a?JSON.parse(localStorage.getItem(e)):null}var s={},a="localStorage"in window&&null!==window.localStorage,c={has:function(e){return e in s||a&&null!==localStorage.getItem(e)},get:function(e){return null!==n(e)?n(e):o(e)},set:function(e,t){s[e]=t,a&&localStorage.setItem(e,JSON.stringify(t))},remove:function(e){delete s[e],a&&localStorage.removeItem(e)}};i.exports=c},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/button/view",["marionette@~1.4.0","underscore@~1.5.0","zepto-wepp@~1.1.0","wepp@~2.7.0","./template.html"],function(e,t,i){var n=e("marionette"),o=e("underscore"),s=e("zepto-wepp"),a=e("wepp").UI;i.exports=n.ItemView.extend({template:o.template(e("./template.html")),className:"div",events:{"click .J_submit":"formSubmit"},formSubmit:function(e){e.preventDefault();var t=(s(e.target),this.model);return t.get("causeIndex")?void this.page.message("alert:show"):void a.alert("请选择退款原因")}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/button/controller",["marionette@~1.4.0","./view","underscore@~1.5.0"],function(e,t,i){{var n=e("marionette"),o=e("./view");e("underscore")}i.exports=n.Controller.extend({initialize:function(e){this.view=new o({model:e})},show:function(e,t){this.view.page=t,e.show(this.view)}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/alert/template.html",[],function(e,t,i){i.exports='<div class="overlay"></div><div class="confirm_alert"><div class="alert_content"><%=content%></div><div class="alert_buttons"><%buttons.forEach(function(btn){%><a href="<%=(btn.url||\'javascript:;\')%>"><%=btn.text%></a><%});%></div></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/cause/controller",["marionette@~1.4.0","./view","underscore@~1.5.0"],function(e,t,i){{var n=e("marionette"),o=e("./view");e("underscore")}i.exports=n.Controller.extend({initialize:function(e){this.view=new o({model:e})},show:function(e){e.show(this.view)}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/footmenu/template.html",[],function(e,t,i){i.exports='<footer class="footer-menu"><div class="more-banner on Fix" style="display:none;"><div class="row Fix"><a href="#citylist" onclick="ThisApp.mv({\'module\':\'more_city\'})"><i class="icon city"></i><span class="sub"><b>当前城市</b><span class="J_c_city"></span></span></a><a href="#receiptlist" onclick="ThisApp.mv({\'module\':\'more_coupon\'})"><i class="icon group"></i><span class="sub">团购券</span></a><a href="#my" onclick="ThisApp.mv({\'module\':\'more_account\'})"><i class="icon userinfo"></i><span class="sub">账号</span></a></div></div><div class="menu-banner Fix"><a href="#chosen" class="on" onclick="ThisApp.mv({module:\'navi_index\'})"><i class="icon select"></i><span class="sub">精选美食</span><i class="noti hide"></i></a><a href="#list~f_2~c_10" onclick="ThisApp.mv({module:\'navi_nearby\'})"><i class="icon nearby"></i><span class="sub">附近团购</span></a><a href="javascript:;" onclick="ThisApp.mv({module:\'navi_more\'})"><i class="icon more"></i><span class="sub">更多</span></a></div></footer>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/content/controller",["marionette@~1.4.0","./view","underscore@~1.5.0"],function(e,t,i){{var n=e("marionette"),o=e("./view");e("underscore")}i.exports=n.Controller.extend({initialize:function(e){this.view=new o({model:e})},show:function(e){e.show(this.view)}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/content/template.html",[],function(e,t,i){i.exports='<div class="tit-box"><h3><%=title%></h3><div class="intro">你有<strong><%=count%></strong>张可退的团购券，请选择要退回的数量</div></div><div class="dv-box count Fix"><div class="sub">退回数量</div><div class="f-r"><a class="<%if(selectIndex==0){%>dis J_un<%}%> op J_count_sub" href="javascript:void(0)">-</a><input readonly type="text" value="<%=(selectIndex+1)%>" class="buy-cnt"><a class="<%if(selectIndex==arrIndex){%>dis J_un<%}%> op J_count_add" href="javascript:void(0)">+</a></div></div><table class="tb-box"><thead><tr><td class="w-70">退回金额<%if(notePush[selectIndex]){%><div class="tip"><%=notePush[selectIndex]%></div><%}%></td><td  class="Fix w-30 t-r"><span class="total-price">¥<%=amountPush[selectIndex]%></span></td></tr></thead></table><div class="sb-box"><div class="tit">退款方式</div><div class="cnt"><table class="tb-box"><thead><tr><td class="w-80"><div class="sub">原路退回</div><div class="tip gray">3-10个工作日完成，暂不收手续费</td><td  class="Fix w-20 t-r"><div class="checked-icon on"></div></td></tr></thead></table></div></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/entities/refund",["backbone@~1.1.0"],function(e,t,i){var n=e("backbone"),o=n.Model.extend({baseUrl:"/ajax/tuan/refundgn.json",initialize:function(e){return this.orderId=e,this.setUrl(),this},parse:function(e){var t=this,i=e.data;return 200==e.code?(i.amountPush=i.amount.split(","),i.notePush=i.note.split("|"),i.receiptListPush=i.receiptList.split(","),i.arrIndex=i.receiptListPush.length-1||0,i.count=i.receiptListPush.length||0,i.selectIndex=0,i.causeIndex="",i.orderId=t.orderId,i.submiting=!1):i.error=400==e.code?"400":"500",i},setUrl:function(){this.url=this.baseUrl+"?orderid="+this.orderId}});i.exports=o},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/refund/cause/template.html",[],function(e,t,i){i.exports='<div class="sb-box"><div class="tit">退款原因</div><div class="cnt"><a href="javascrpt:void(0)"  data="1" class="dv-box on J_cause_select Fix"><div class="sub">买多了/买错了</div><div class="f-r"><div class="checked-icon <%if(causeIndex==1){%>on<%}%>"></div></div></a><a href="javascrpt:void(0)"  data="2" class="J_cause_select dv-box Fix"><div class="sub">计划有变，没时间消费</div><div class="f-r"><div class="checked-icon <%if(causeIndex==2){%>on<%}%>"></div></div></a><a href="javascrpt:void(0)" data="3" class="J_cause_select dv-box Fix"><div class="sub">预约有变</div><div class="f-r"><div class="checked-icon <%if(causeIndex==3){%>on<%}%>"></div></div></a><a href="javascrpt:void(0)" data="4" class="J_cause_select dv-box Fix"><div class="sub">评价不好</div><div class="f-r"><div class="checked-icon <%if(causeIndex==4){%>on<%}%>"></div></div></a><a href="javascrpt:void(0)" data="5" class="J_cause_select dv-box Fix"><div class="sub">后悔了,不想要了</div><div class="f-r"><div class="checked-icon <%if(causeIndex==5){%>on<%}%>"></div></div></a><a href="javascrpt:void(0)" data="6" class="J_cause_select dv-box Fix"><div class="sub">其他原因</div><div class="f-r"><div class="checked-icon <%if(causeIndex==6){%>on<%}%>"></div></div></a></div></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/app",["wepp@~2.7.0","./base/share","./modules/common/footmenu/controller","./util/geolocation","./util/cache","zepto-wepp@~1.1.0","./modules/common/first","./config/deviceconfig","./config/routeconfig","./config/envconfig","./modules/common/overlay","hippo@~1.2.0","./filters/login"],function(e,t,i){var n=e("wepp"),o=e("./base/share"),s=e("./modules/common/footmenu/controller"),a=e("./util/geolocation"),c=n.Module.Performance,r=e("./util/cache"),l=e("zepto-wepp");e("./modules/common/first").firstVisit()||localStorage.setItem("cityselect",!0);var d=i.exports=window.ThisApp=n.App.create({device:e("./config/deviceconfig"),router:e("./config/routeconfig")});e("./config/envconfig"),d.Menu=new s,d.routerManager.pageLoader=function(t,i){e.async(t[0],i)};var p=!0;d.routerManager.on("before:route:change",function(){p||n.UI.loading.show(),p=!1,d.Menu.hide()}),d.routerManager.on("route:change",function(e,t){n.UI.loading.hide(),e.share?(t.trigger&&t.trigger("before_share_config",e.share),o.enable(!0),o.config(e.share)):o.enable(!1)}),d.Geo=a,d.Share=o,d.Overlay=e("./modules/common/overlay"),d.mv=function(t){e("hippo").push(["mv",t])},d.Cache=r,d.isLogin=window.WEIXIN_CONFIG&&+window.WEIXIN_CONFIG.userId,d.routerManager.constructor.filters={login:e("./filters/login")},c.setFrameTime(),l(".welcome").remove(),d.start()},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/deviceconfig",[],function(e,t,i){i.exports={iphone4:{pageLength:4},iphone5:{pageLength:5},android2x:{pageLength:3},"android3+":{pageLength:3},"default":{pageLength:3}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/pages/refund",["zepto-wepp@~1.1.0","underscore@~1.5.0","wepp@~2.7.0","../app","../entities/refund","../modules/refund/content/controller","../modules/refund/cause/controller","../modules/refund/button/controller","../util/cache","../modules/common/alert/controller","../modules/refund/layout.html"],function(e,t){var i,n=e("zepto-wepp"),o=e("underscore"),s=e("wepp"),a=e("../app"),c=e("../entities/refund"),r=e("../modules/refund/content/controller"),l=e("../modules/refund/cause/controller"),d=e("../modules/refund/button/controller"),p=e("../util/cache"),u=s.UI,h=e("../modules/common/alert/controller"),m=s.PageController.extend({initialize:function(){var e=this;this.onMessage("alert:show",function(){e.showAlert()}),this.onMessage("alert:submit",function(){var t=e.model,i=t.get("selectIndex");t.set("submiting",!0),n.ajax({url:"/ajax/tuan/submitrefundgn.json",type:"POST",data:{orderid:t.get("orderId"),amount:t.get("amountPush")[i],type:2,reason:t.get("causeIndex"),pcode:n.os.ios?20010500:20010400,receiptid:t.get("receiptListPush").splice(0,i+1).join(",")},success:function(e){200==e.code?(u.alert("退款申请已提交，客服会尽快为您处理"),setTimeout(function(){ThisApp.redirect("#receiptlist",!0)},1200)):(u.alert("系统错误"),t.set("submiting",!1))},error:function(){u.alert("系统繁忙"),t.set("submiting",!1)}})})},show:function(t){var n=this;a.openPage().then(function(s){i=n.model=new c(t),i.set("title",p.get("refundTitle")||"test"),s.initRegion({template:o.template(e("../modules/refund/layout.html")),regions:{header:".J_header",cnt:".J_cnt",cause:".J_cause",button:".J_button",alert:"J_alert"}}),i.on("change",function(){var e=i.get("error");e?400==e?(u.alert("本订单已有退款申请正在处理。退款成功后，你可以申请退款本订单的其它团购券。",3e3),setTimeout(function(){ThisApp.redirect("#receiptlist",!0)},3e3)):(u.alert("系统错误"),setTimeout(function(){ThisApp.redirect("#receiptlist",!0)},1200)):(n.showCnt(s.layout.cnt),n.showCause(s.layout.cause),n.showButton(s.layout.button),n.showButton(s.layout.button))}),i.fetch()},function(){i.fetch()})},showCnt:function(e){var t=new r(this.model,this);t.show(e)},showCause:function(e){var t=new l(this.model,this);t.show(e)},showButton:function(e){var t=new d(this.model);t.show(e,this)},showAlert:function(){var e=this,t=new h({content:"退款申请一旦提交，团购券将不能恢复",buttons:[{text:"取消",click:function(){t.hide()}},{text:"确认退款",click:function(){t.hide(),e.message("alert:submit")}}]});t.show()}});t.Controller=m},{asyncDeps:["iscroll@~5.0.9"]});