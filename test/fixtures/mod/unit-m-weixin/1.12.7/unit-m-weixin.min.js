define("unit-m-weixin@1.12.7/js/modules/common/alert/template.html",[],function(e,i,t){t.exports='<div class="overlay"></div><div class="confirm_alert"><div class="alert_content"><%=content%></div><div class="alert_buttons"><%buttons.forEach(function(btn){%><a href="<%=(btn.url||\'javascript:;\')%>"><%=btn.text%></a><%});%></div></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/routeconfig",[],function(e,i,t){var n={title:"点评团·放心团",desc:"吃喝玩乐，应有尽有，随时随地，想团就团，快来试试吧！"};t.exports={"":{pv:{pageId:"172001"},share:n,appjs:["./pages/index"],method:"show"},chosen:{appjs:["./pages/chosen"],method:"show",pv:{pageId:"172019"},share:{title:"吃喝玩乐尽在大众点评",desc:"好吃，好玩，还省钱"}},"list(~k_:keyword)(~c_:category)(~r_:region)(~f_:filter)(~lng_:lng)(~lat_:lat)":{pv:{pageId:"172001"},share:n,appjs:["./pages/index"],method:"show"},"detail~:id":{pv:{pageId:"172002"},share:{},appjs:["./pages/detail"],method:"show"},"detailmore~:id":{pv:{pageId:"172003"},appjs:["./pages/detailmore"],method:"show"},"shoplist~:id":{pv:{pageId:"172004"},appjs:["./pages/shoplist"],method:"show"},"order~g_:groupId~d_:dealId":{pv:{pageId:"172006"},appjs:["./pages/pay"],method:"show"},"orderconfirm~:id":{pv:{pageId:"172009"},appjs:["./pages/orderconfirm"],method:"show"},"orderdetail~:id":{pv:{pageId:"172014"},appjs:["./pages/orderdetail"],method:"show"},paypromo:{appjs:["./pages/paypromo"],method:"show"},"promo~:orderid":{pv:{pageId:"172010"},appjs:["./pages/promo"],method:"show"},receiptlist:{pv:{pageId:"172012"},appjs:["./pages/receiptlist"],method:"show",filters:["login"]},"receiptdetail~:id":{pv:{pageId:"172013"},appjs:["./pages/receiptdetail"],method:"show",filters:["login"]},"deliveryadd~:index":{pv:{pageId:"172007"},appjs:["./pages/deliveryadd"],method:"show"},deliverylist:{pv:{pageId:"172008"},appjs:["./pages/deliverylist"],method:"show"},"dealselect~g_:id":{pv:{pageId:"172005"},appjs:["./pages/dealselect"],method:"show"},"paysuc~:id":{pv:{pageId:"172011"},appjs:["./pages/paysuc"],share:n,method:"show"},alertinfo:{appjs:["./pages/alertinfo"],method:"show"},couponlist:{appjs:["./pages/couponlist"],method:"show",pv:{pageId:"172015"},filters:["login"]},my:{appjs:["./pages/my"],method:"show",pv:{pageId:"172016"},filters:["login"]},citylist:{appjs:["./pages/citylist"],method:"show",pv:{pageId:"172017"}},"refund~:id":{appjs:["./pages/refund"],method:"show"},innertest:{appjs:["./pages/test"],method:"show"},orderlist:{appjs:["./pages/orderlist"],method:"show",filters:["login"],pv:{pageId:"172018"}}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/envconfig",["wepp@~2.7.0"],function(e){var i=e("wepp").ENV;i.config("appid",{beta:"wx1613983303fce900",pre:"wx841a97238d9e17b2",online:"wx841a97238d9e17b2"}),i.config("cpsUrl",{beta:"http://tcps.51ping.com",pre:"http://cps.dianping.com",online:"http://cps.dianping.com"}),i.config("mmUrl",{beta:"http://mm.51ping.com",pre:"http://ppe.mm.dianping.com",online:"http://mm.dianping.com"}),i.config("payDomain",{beta:"http://api.p.51ping.com",pre:"http://ppe.api.p.dianping.com",online:"http://api.p.dianping.com"}),i.config("accountDomain",{beta:"http://m.51ping.com",pre:"http://ppe.m.dianping.com",online:"http://m.dianping.com"})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/overlay",["zepto-wepp@~1.1.0","underscore@~1.5.0","backbone@~1.1.0"],function(e,i,t){function n(e){var i=this;this.container=e||"body";var t=this.overlay=c();t.on("touchstart touchmove touchend",function(e){e.preventDefault()}),t.on("touchstart click",function(){i.hide()})}var o=e("zepto-wepp"),s=e("underscore"),a=e("backbone"),c=function(){return o('<div class="overlay" style="z-index:200;"></div>')};n.prototype.show=function(){this.overlay.appendTo(this.container).show(),this.trigger("show")},n.prototype.hide=function(){this.overlay.hide(),this.trigger("hide")},s.extend(n.prototype,a.Events),t.exports=n},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/config/deviceconfig",[],function(e,i,t){t.exports={iphone4:{pageLength:4},iphone5:{pageLength:5},android2x:{pageLength:3},"android3+":{pageLength:3},"default":{pageLength:3}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/chosen/controller",["zepto-wepp@~1.1.0","../../entities/chosen","wepp@~2.7.0","./template.html","../../util/lazyload","hippo@~1.2.0"],function(e,i,t){var n=e("zepto-wepp"),o=e("../../entities/chosen");t.exports=e("wepp").Module.BaseController.extend({initModel:function(e){return new o(e)},initTpl:function(){return e("./template.html")},onRender:function(){var i=this,t=i.view,o=t.$el.find(".img");o.length&&o.height(200*o.width()/320),o.find("img").each(function(e,i){n(i).on("load",function(){n(this).parent().css("height","auto")})}),e("../../util/lazyload")(t.$el.find(".img img")),i.show=function(){t.$el.show()},i.hide=function(){t.$el.hide()};var s=e("hippo");s.push(["mv",{module:"index_recom_view",action:"browse",reqid:this.model.get("request_id")}]),t.$el.find(".nearby-deallist a").each(function(e,t){n(t).on("click",function(){s.push(["mv",{module:"index_recom_item",action:"click",index:e,reqid:i.model.get("request_id")}])})}),i.trigger("render")},hide:function(){},show:function(){}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/search/controller",["marionette@~1.4.0","wepp@~2.7.0","./template.html","zepto-wepp@~1.1.0","underscore@~1.5.0","backbone@~1.1.0"],function(e,i,t){function n(){var e=p.getName()||"";return e.length>3?e.substr(0,2)+"..":e}var o=e("marionette"),s=e("wepp").Module,a=s.BaseView(e("./template.html")),c=e("zepto-wepp"),r=e("underscore"),l=e("backbone"),p=s.City,d=o.Controller.extend({initialize:function(e){var i={showCity:!0,showBack:!1};this.options=r.extend(i,e||{}),this.view=new a({model:new l.Model({history:d.History.get(),cityname:n(),showCity:this.options.showCity,showBack:this.options.showBack})})},show:function(e,i){e.show(this.view);var t=this.view.$el;this.searchBox=t.find(".J_search_box"),this.cancelBtn=t.find(".J_cancel"),this.backBtn=t.find(".J_back"),this.historyHolder=t.find(".J_history"),this.historyList=t.find(".J_history ul"),this.clearBtn=t.find(".J_history .clear"),this.cityBox=t.find(".city"),this.trigger("show"),i&&this.setKeywords(i),this.bindEvents()},search:function(e){d.History.add(e),this.searchBox.val(e),this.trigger("search",e)},cancel:function(){var e=this;this.searchBox.parent().removeClass("float"),this.cityBox.removeClass("float"),this.searchBox.get(0).blur(),this.backBtn.show().addClass("on"),this.cancelBtn.hide(),setTimeout(function(){e.historyHolder.hide()},400),this.trigger("blur")},setKeywords:function(e){this.view.$el.find(".J_search_box").val(e)},bindEvents:function(){var e=this,i=this.view.$el;i.find("form").on("submit",r.bind(this.submit,this)),this.searchBox.on("focus",function(){e.onFocus()}),this.searchBox.on("touchstart",function(){e.trigger("touch")}),this.searchBox.on("blur",function(){e.cancel()}),this.cancelBtn.on("click",function(){e.cancel()}),this.historyList.on("click","li",function(i){e.cancel(),e.search(i.currentTarget.innerText)}),d.History.on("add",function(i){e.append(i)}),d.History.on("pop",function(){var i=e.historyList.children();i.eq(i.length-1).remove()}),d.History.on("clear",function(){e.historyList.empty()}),this.clearBtn.on("click",function(){d.History.clear(),e.refresh()}),p.on("change",function(){e.view.$el.find(".city a").html(n())})},submit:function(e){e.preventDefault();var i=this.searchBox.val();this.cancel(),i&&this.search(i)},append:function(e){this.historyList.prepend("<li>"+e+"</li>"),this.refresh()},showHistory:function(){this.historyHolder.show().css("height",c(window).height()-40),this.refresh()},initIscroll:function(){var i=this;e.async("iscroll",function(e){i.scroll=new e(i.historyHolder.get(0),{mouseWheel:!0,click:!0})})},refresh:function(){this.scroll?this.scroll.refresh():this.initIscroll()},onFocus:function(){this.searchBox.parent().addClass("float"),this.cityBox.addClass("float"),this.showCancel(),this.showHistory(),this.trigger("focus")},showBack:function(){this.backBtn.show().addClass("on"),this.cancelBtn.hide()},showCancel:function(){this.backBtn.hide(),this.cancelBtn.show()}});d.History={KEY:"search_history",get:function(){var e=window.localStorage.getItem(this.KEY);return e?e.split(","):[]},add:function(e){var i=this.get();-1===i.indexOf(e)&&(i.unshift(e),i.length>20&&(i.pop(),this.trigger("pop")),window.localStorage.setItem(this.KEY,i.join(",")),this.trigger("add",e))},clear:function(){window.localStorage.removeItem(this.KEY),this.trigger("clear")}},r.extend(d.History,l.Events),t.exports=d},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/appdownload/controller",["marionette@~1.4.0","wepp@~2.7.0","./template.html","backbone@~1.1.0","zepto-wepp@~1.1.0","../overlay"],function(e,i,t){var n=e("marionette"),o=e("wepp").Module.BaseView(e("./template.html")),s=e("backbone"),a=e("zepto-wepp");t.exports=n.Controller.extend({initialize:function(i){var t=new s.Model(i),n=new o({model:t});i.region.show(n),t.get("mv")&&n.$el.find(".J_d").on("click",function(){ThisApp.mv(t.get("mv"))});var c=n.$el.find(".J_share");if(c.length){var r=new(e("../overlay")),l=a('<div class="shareguide"></div>').appendTo("body").hide();r.on("show",function(){r.overlay.css({"background-color":"rgba(0,0,0,.9)","z-index":900}),l.show()}),r.on("hide",function(){l.hide()}),l.on("click",function(){r.hide()}),c.on("click",function(e){e.preventDefault(),r.show(),setTimeout(function(){r.hide()},5e3)})}}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/alert/controller",["wepp@~2.7.0","./template.html","backbone@~1.1.0","marionette@~1.4.0","underscore@~1.5.0","zepto-wepp@~1.1.0"],function(e,i,t){var n=e("wepp").Module.BaseView(e("./template.html")),o=e("backbone"),s=e("marionette"),a=(e("underscore"),e("zepto-wepp"));t.exports=s.Controller.extend({initialize:function(e){this.view=new n({model:new o.Model(e)}),this.view.render(),this.box=this.view.$el.hide().appendTo("body"),this.box.find(".alert_buttons a").each(function(i,t){e.buttons[i].click&&a(t).on("click",e.buttons[i].click)}),e.buttons&&1===e.buttons.length&&this.box.find(".alert_buttons a").css("width","100%")},show:function(){this.box.show();var e=this.box.find(".confirm_alert");e.css("margin-top",-e.height()/2)},hide:function(){this.box.hide()}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/chosen/layout.html",[],function(e,i,t){t.exports='<div class="nearby"><div class="search_holder Fix"></div><div class="J_cnt"><div class="loading" style="height:400px;"></div></div><div class="download"></div></div><div class="height-box"></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/first",["wepp@~2.7.0"],function(e,i,t){var n=e("wepp").Url;t.exports={firstVisit:function(){return null===localStorage.getItem("cityselect")},firstSelect:function(){return"first"===localStorage.getItem("cityselect")},checkFirst:function(){var e=n.get("cityid");return!e&&this.firstVisit()?(localStorage.setItem("cityrefer",location.hash),ThisApp.redirect("#citylist",!0),!0):!1}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/footmenu/template.html",[],function(e,i,t){t.exports='<footer class="footer-menu"><div class="more-banner on Fix" style="display:none;"><div class="row Fix"><a href="#citylist" onclick="ThisApp.mv({\'module\':\'more_city\'})"><i class="icon city"></i><span class="sub"><b>当前城市</b><span class="J_c_city"></span></span></a><a href="#receiptlist" onclick="ThisApp.mv({\'module\':\'more_coupon\'})"><i class="icon group"></i><span class="sub">团购券</span></a><a href="#my" onclick="ThisApp.mv({\'module\':\'more_account\'})"><i class="icon userinfo"></i><span class="sub">账号</span></a></div></div><div class="menu-banner Fix"><a href="#chosen" class="on" onclick="ThisApp.mv({module:\'navi_index\'})"><i class="icon select"></i><span class="sub">精选美食</span><i class="noti hide"></i></a><a href="#list~f_2~c_10" onclick="ThisApp.mv({module:\'navi_nearby\'})"><i class="icon nearby"></i><span class="sub">附近团购</span></a><a href="javascript:;" onclick="ThisApp.mv({module:\'navi_more\'})"><i class="icon more"></i><span class="sub">更多</span></a></div></footer>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/util/cache",[],function(e,i,t){function n(e){return e in s?s[e]:null}function o(e){return a?JSON.parse(localStorage.getItem(e)):null}var s={},a="localStorage"in window&&null!==window.localStorage,c={has:function(e){return e in s||a&&null!==localStorage.getItem(e)},get:function(e){return null!==n(e)?n(e):o(e)},set:function(e,i){s[e]=i,a&&localStorage.setItem(e,JSON.stringify(i))},remove:function(e){delete s[e],a&&localStorage.removeItem(e)}};t.exports=c},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/entities/chosen",["backbone@~1.1.0","underscore@~1.5.0","wepp@~2.7.0"],function(e,i,t){var n=e("backbone"),o=e("underscore"),s=e("wepp"),a=s.Url,c=s.Module.City;t.exports=n.Model.extend({initialize:function(e){var i=o.extend({from:"weixin",category:10,distance:2e3,number:20,type:1},e);this.url="getwxhomepagedatagn.json?"+a.stringify(i)},parse:function(e){if(e&&200===e.code){var i=e.data.recommendDeals;i.city&&c.set({id:i.city.id,name:i.city.name,enName:i.city.enName});var t=(i.list||[]).map(function(e){return e.shopNum=e.shopIdsStr?e.shopIdsStr.split(",").length:0,e});return{categoryList:e.data.categoryList&&e.data.categoryList.list||[],recommendList:t||[],hotModules:e.data.hotModules||[],request_id:e.request_id}}return{categoryList:[],recommendList:[],hotModules:[],request_id:e.request_id}}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/util/geolocation",["backbone@~1.1.0","zepto-wepp@~1.1.0","underscore@~1.5.0","cookie@~0.1.0"],function(e,i,t){var n,o=(e("backbone"),e("zepto-wepp")),s=e("underscore"),a=e("cookie"),c=.5/60/24,r="lng",l="lat",p=function(){return a(r)?{lat:a(l),lng:a(r)}:null},d=function(e,i,t){a("lng",i,{expires:c}),a("lat",e,{expires:c}),a("geocityid",t,{expires:c})},h=function(e,i){navigator.geolocation.getCurrentPosition(function(i){var t=i.coords,n=t.longitude,o=t.latitude;e({lng:n,lat:o})},i,{enableHighAccuracy:!0,timeout:3e3,maximumAge:3e3})},u={fetching:!1,get:function(e){function i(i){u.fetching=!1,e?u.getCityByGeo(i,function(e){e?(d(i.lat,i.lng,e.id),n.resolve(s.extend(i,e))):(u.fetching=!1,n.reject())}):(d(i.lat,i.lng),n.resolve(i))}if(u.fetching)return n;u.fetching=!0,n=new o.Deferred;var t;return(t=p())?setTimeout(function(){i(t)},0):h(i,function(){u.fetching=!1,n.reject()}),n},getCityByGeo:function(e,i){o.ajax({url:"/ajax/tuan/cityidgn.json",data:{lat:e.lat,lng:e.lng},dataType:"json",success:function(e){i(200==e.code&&e.data&&e.data.id>0?{cityid:e.data.id,cityname:e.data.name,cityenname:e.data.enName}:null)}})},cookieGeo:p};t.exports=u},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/chosen/template.html",[],function(e,i,t){t.exports='<%if(categoryList && categoryList.length){var width=parseInt(window.innerWidth/(categoryList.length));%><div class="category Fix"><%categoryList.forEach(function(cat){var c,url;if(cat.id==0){c=\'bonus\';url=cat.enName}else if(cat.id==10){c=\'food\';url=\'#list~c_10\'}else if(cat.id==30){c=\'fun\';url=\'#list~c_30\'}%><a class="item <%=c%>" style="width:<%=width%>px" href="<%=url%>"><div class="icon"><%if(cat.id==0){%><div class="count <%=cat.count?\'\':\'none\'%>"><%=cat.count?(cat.count>99?\'+99\':cat.count):\'\'%></div><%}%></div><%=cat.name%></a><%});%></div><%}%><div class="c-box-tit" style="color:#969696">猜你喜欢</div><div class="nearby-deallist"><%recommendList.forEach(function(deal,i){%><a href="#detail~<%=deal.id%>"><div class="img"><img lazy-src="<%=deal.bigImageUrl%>" width="100%" height="auto"></div><div class="tit"><%=deal.contentTitle%><%if(deal.shopNum && deal.shopNum>1){%><span class="shop-total">【<%=deal.shopNum%>店通用】</span><%}%></div><div class="tip"><%=deal.titleDesc%></div><div class="price"><span class="new-price">￥<%=deal.price%></span><span class="old-price">￥<%=deal.originalPrice%></span><span class="buy-num"><%=deal.buyerCounter%>人</span></div></a><%});%></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/footmenu/controller",["marionette@~1.4.0","wepp@~2.7.0","./template.html","zepto-wepp@~1.1.0","../overlay","underscore@~1.5.0"],function(e,i,t){var n=e("marionette"),o=e("wepp").Module.BaseView(e("./template.html")),s=e("zepto-wepp"),a=e("../overlay"),c=e("wepp").Module.City,r=e("underscore"),l="food_bubble",p=n.Controller.extend({initialize:function(){this.view=new o,this.view.render(),localStorage.getItem(l)||this.view.$el.find(".noti").removeClass("hide"),this.setCity(),s("body").append(this.view.$el.hide()),this.menus=this.view.$el.find(".menu-banner a"),this.more=this.view.$el.find(".more-banner"),this.overlay=new a,this.currentIndex=-1,this.tempCloseMore=!1,this.events()},show:function(e){return this.tempCloseMore&&!e&&(this.tempCloseMore=!1,this.showMore()),this.view.$el.show(),this},hide:function(){return this.view.$el.hide(),this},switchTo:function(e,i,t){return e!==this.currentIndex||t?(i!==!1&&(this.currentIndex=e),this.menus.removeClass("on").eq(e).addClass("on"),0===e&&(localStorage.setItem(l,!0),this.view.$el.find(".noti").addClass("hide")),this):void 0},events:function(){var e=this,i=this.menus;i.each(function(t,n){t!=i.length-1&&s(n).on("click",function(){e.hideMore(),e.switchTo(t)})}),i.eq(i.length-1).on("click",r.bind(e.toggleMore,e)),this.more.find("a").on("click",function(){e.tempCloseMore=!0,e.hideMore()}),this.overlay.on("hide",function(){e.switchTo(e.currentIndex,!0,!0),e.more.hide()}),c.on("change",r.bind(e.setCity,e))},showMore:function(){this.switchTo(2,!1),this.more.show(),this.overlay.show(),this._more_show=!0},hideMore:function(){this.overlay.hide(),this._more_show=!1},toggleMore:function(){this._more_show?this.hideMore():this.showMore()},setCity:function(){this.view.$el.find(".J_c_city").html(c.getName())},setUrl:function(e,i){this.menus.eq(e).attr("href",i)}});t.exports=p},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/util/lazyload",["zepto-wepp@~1.1.0"],function(e,i,t){var n=e("zepto-wepp"),o="lazy-src",s=function(e){var i=e.slice(0),t=i.length,s=function(){for(var e=n(window).scrollTop()+window.innerHeight,a=0,c=i.length;c>a;a++){var r=n(i[a]);!r.attr("src")&&r.attr(o)&&e>n(r).offset().top&&(r.attr("src",r.attr(o)),t--)}0>=t&&window.removeEventListener("scroll",s,!1)};window.addEventListener("load",s,!1),window.addEventListener("scroll",s,!1),s()};t.exports=s},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/base/share",["wepp@~2.7.0","underscore@~1.5.0","zepto-wepp@~1.1.0"],function(e,i,t){function n(){var e=a.link.match(/\?([^#$]*)/),i={};e&&(i=s.parse(e[1])),i.utm="wxshare";var t=a.link.replace(/(\?[^#$]*)/,"");a.link=t.replace(/((:?#[\w\W]*)|$)/,function(e,t){return"?"+s.stringify(i)+t}),console.log(a.link)}function o(){l||window.WeixinJSBridge&&(l=!0,WeixinJSBridge.on("menu:share:appmessage",function(){r&&(n(),WeixinJSBridge.invoke("sendAppMessage",a,function(){}))}),WeixinJSBridge.on("menu:share:timeline",function(){if(r){n();var e=c.clone(a);e.title=e.timelineTitle||e.title,WeixinJSBridge.invoke("shareTimeline",e,function(){})}}),e("zepto-wepp").os.ios&&WeixinJSBridge.call("hideToolbar"))}var s=e("wepp").Url,a={appid:"wx841a97238d9e17b2",img_url:"",img_width:"640",img_height:"640",link:"",desc:"",title:"",timelineTitle:""},c=e("underscore"),r=!1,l=!1;o(),document.addEventListener("WeixinJSBridgeReady",o,!1),t.exports={config:function(e){a=c.extend(a,e)},enable:function(e){r=e;try{l?WeixinJSBridge.call(r?"showOptionMenu":"hideOptionMenu"):r?document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.call("showOptionMenu")},!1):document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.call("hideOptionMenu")},!1)}catch(i){}},linkPre:n,__config__:a}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/search/template.html",[],function(e,i,t){t.exports='<form action="" method="post"><%if(showCity){%><div class="city"><a href="#citylist" onclick="ThisApp.mv({module:\'index_city\'})" ><%=cityname%></a><i class="drop"></i></div><%}%><div class="search_inner <%=showCity?\'\':\'first\'%>"><input type="text" placeholder="商户名，地址等..." class="J_search_box search_box"/><a class="cancel J_cancel" href="javascript:;">取消</a><%if(showBack){%><a class="cancel J_back" href="javascript:history.go(-1);">返回</a><%}%><input type="submit" class="hide"></div></form><div class="J_history history"><div><ul><%history.forEach(function(item){%><li><%=item%></li><%});%></ul><a href="javascript:;" class="clear">清除搜索记录</a></div></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/pages/chosen",["zepto-wepp@~1.1.0","underscore@~1.5.0","wepp@~2.7.0","../modules/chosen/controller","../modules/common/first","../modules/common/search/controller","../modules/common/appdownload/controller","../modules/common/alert/controller","../modules/chosen/layout.html"],function(e,i){var t=(e("zepto-wepp"),e("underscore")),n=e("wepp"),o=e("../modules/chosen/controller"),s=n.Module.City,a=n.UI,c=e("../modules/common/first"),r=e("../modules/common/search/controller"),l=e("../modules/common/appdownload/controller"),p=e("../modules/common/alert/controller");i.Controller=n.PageController.extend({show:function(){ThisApp.Menu.show().switchTo(0),this.firstSelect=c.firstSelect();var e=this;ThisApp.openPage(!0).then(function(i){e.page=i,e.region(),e.fetchList(i)},function(i){e.page=i,i._cached_city!=s.getId()&&(ThisApp.Menu.setUrl(1,"#list~c_10~f_2"),e.fetchList(e.page))})},fetchList:function(e){var i=this;i.initSearch(e.layout.search),i.cookieGeo()||ThisApp.Geo.get(!0).then(function(e){i.geo(e)},function(){if(!i.firstSelect&&ThisApp.pageRegion.isCurrentPage(i.page)){var e=new p({content:"无法获取到您的定位",buttons:[{text:"切换城市",url:"#citylist",click:function(){e.hide()}},{text:"取消",click:function(){e.hide(),i.showCurrentCity()}}]});a.loading.hide(),e.show()}else i.showCurrentCity()})},showChosen:function(e){var i=this,t=this.chosen=new o(e);t.render(this.page.layout.chosen);var n=+new Date;e.lat&&this.setNearByUrl(e.lat,e.lng),t.model.on("change",function(e){i.performance.set({r_api:+new Date-n});var t=e.get("list");ThisApp.Share.config({img_url:t&&t[0]&&t[0].bigImageUrl,link:location.href})}),i.page._cached_city=e.cityid,t.on("render",function(){i.download(),i.performance.set({r_ready:+new Date-i.performance.startTime,r_load:+new Date-i.performance.startTime})})},region:function(){this.page.initRegion({template:t.template(e("../modules/chosen/layout.html")),regions:{search:".search_holder",chosen:".J_cnt",download:".download"}})},cookieGeo:function(){var e=ThisApp.Geo.cookieGeo();return e&&e.cityid===s.getId()?(this.showGeoCity(e),!0):!1},geo:function(e){var i=this;if(s.getId()==e.cityid)this.showGeoCity(e);else if(!this.firstSelect&&ThisApp.pageRegion.isCurrentPage(this.page)){var t=new p({content:"系统定位到您在"+e.cityname+",是否切换?",buttons:[{text:"取消",click:function(){i.showCurrentCity(),t.hide()}},{text:"切换",click:function(){t.hide(),i.showGeoCity(e)}}]});a.loading.hide(),t.show()}else i.showCurrentCity()},showGeoCity:function(e){this.showChosen({cityid:e.cityid,lat:e.lat,lng:e.lng})},showCurrentCity:function(){this.showChosen({cityid:s.getId()})},setNearByUrl:function(e,i){ThisApp.Menu.setUrl(1,"#list~c_10~f_2~lat_"+e+"~lng_"+i)},initSearch:function(e){var i=this,t=new r;t.show(e),t.on("touch",function(){ThisApp.Menu.hide()}),t.on("focus",function(){ThisApp.Menu.hide(),i.chosen&&i.chosen.hide(),ThisApp.mv({module:"index_search"})}),t.on("blur",function(){ThisApp.Menu.show(),i.chosen&&i.chosen.show()}),t.on("search",function(e){ThisApp.redirect("#list~k_"+encodeURIComponent(e))})},download:function(){new l({url:"http://m.api.dianping.com/downloadlink?redirect=3123",region:this.page.layout.download,tipText:"喜欢精选美食频道吗?",popText:"发现更多优惠，还能获得现金返利",mv:{module:"index_download"}})}})},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/modules/common/appdownload/template.html",[],function(e,i,t){t.exports='<div class="tip-cnt"><p><%=tipText%></p><p>点击右上角<strong><span class="J_share">【收藏】</span></strong>或<strong><span class="J_share">【分享】</span></strong>给小伙伴们！</p></div><div class="appload"><a href="<%=url%>" class="tip"><i class="arr"></i><%=popText%></a><a href="<%=url%>" class="link J_d"><i class="logo"></i>马上去大众点评享优惠</a></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/app",["wepp@~2.7.0","./base/share","./modules/common/footmenu/controller","./util/geolocation","./util/cache","zepto-wepp@~1.1.0","./modules/common/first","./config/deviceconfig","./config/routeconfig","./config/envconfig","./modules/common/overlay","hippo@~1.2.0","./filters/login"],function(e,i,t){var n=e("wepp"),o=e("./base/share"),s=e("./modules/common/footmenu/controller"),a=e("./util/geolocation"),c=n.Module.Performance,r=e("./util/cache"),l=e("zepto-wepp");e("./modules/common/first").firstVisit()||localStorage.setItem("cityselect",!0);var p=t.exports=window.ThisApp=n.App.create({device:e("./config/deviceconfig"),router:e("./config/routeconfig")});e("./config/envconfig"),p.Menu=new s,p.routerManager.pageLoader=function(i,t){e.async(i[0],t)};var d=!0;p.routerManager.on("before:route:change",function(){d||n.UI.loading.show(),d=!1,p.Menu.hide()}),p.routerManager.on("route:change",function(e,i){n.UI.loading.hide(),e.share?(i.trigger&&i.trigger("before_share_config",e.share),o.enable(!0),o.config(e.share)):o.enable(!1)}),p.Geo=a,p.Share=o,p.Overlay=e("./modules/common/overlay"),p.mv=function(i){e("hippo").push(["mv",i])},p.Cache=r,p.isLogin=window.WEIXIN_CONFIG&&+window.WEIXIN_CONFIG.userId,p.routerManager.constructor.filters={login:e("./filters/login")},c.setFrameTime(),l(".welcome").remove(),p.start()},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/js/filters/login",["zepto-wepp@~1.1.0","wepp@~2.7.0"],function(e,i,t){var n=e("zepto-wepp"),o=e("wepp").ENV,s=function(){var e=encodeURIComponent("type=quan,url="+location.href),i="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+o.get("appid")+"&redirect_uri="+o.get("cpsUrl")+"/weiXinRedirect&response_type=code&scope=snsapi_base&state="+e+"#wechat_redirect";location.href=i},a=function(e){n.ajax({url:"/ajax/tuan/tuanprofilegn.json?",type:"POST",dataType:"json",success:function(i){200!==i.code&&e()}})};t.exports={check:function(){var e=n.Deferred();return ThisApp.isLogin?(setTimeout(function(){e.resolve()},0),a(s)):(s(),setTimeout(function(){e.reject()},0)),e.promise()}}},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@1.12.7/index",["./js/app","./js/pages/chosen"],function(e,i,t){var n=e("./js/app");e("./js/pages/chosen"),t.exports=n},{asyncDeps:["iscroll@~5.0.9"],main:!0});