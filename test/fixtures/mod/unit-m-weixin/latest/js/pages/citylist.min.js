define("unit-m-weixin@latest/js/modules/citylist/controller",["zepto-wepp@~1.1.0","wepp@~2.7.0","../../entities/citylist","./template.html"],function(t,e,i){var n=t("zepto-wepp"),s=t("wepp"),l=t("../../entities/citylist"),o=s.Module.City,a=s.Module.BaseController,c=a.extend({initModel:function(){var e=new l;return e.set("current",t("wepp").Module.City.getId()),e},initTpl:function(){return t("./template.html")},onRender:function(){this.events(),this.geo()},events:function(){var t=this.model;this.view.$el.find(".J_city").on("click",function(e){var i=n(this).data("id"),s=n(this).data("name");i?(localStorage.setItem("cityselect","first"),o.set({id:i,name:s}),t.set("current",i)):e.preventDefault()}),this.view.$el.find(".J_list dt").on("click",function(){n(this).toggleClass("close").parent().find("dd").toggleClass("hide")})},geo:function(){var t=this.view.$el.find(".J_geo_city"),e=this.model;ThisApp.Geo.get(!0).then(function(i){t.text(i.cityname),t.data("id",i.cityid),t.data("name",i.cityname),t.attr("href",e.get("refer"))},function(){t.text("无法获取您的位置")})}});i.exports=c},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@latest/js/modules/citylist/layout.html",[],function(t,e,i){i.exports='<div class="J_list"><div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@latest/js/entities/citylist",["backbone@~1.1.0","underscore@~1.5.0","wepp@~2.7.0"],function(t,e,i){var n=t("backbone"),s=t("underscore"),l=(t("wepp").Url,n.Model.extend({url:"/ajax/tuan/citygn.json",parse:function(t){var e=[],i=this,n=localStorage.getItem("cityrefer")||"#chosen";localStorage.setItem("cityrefer","");var l=[];return t.data.forEach(function(t){t.url=n;var o=String.fromCharCode(t.firstChar);i._getListIndex(e,o).list.push(t),t.isTop&&l.push(s.clone(t))}),e.sort(function(t,e){return t.name<e.name?-1:1}),{indexList:e,hotList:l,refer:n}},_getListIndex:function(t,e){var i=t.filter(function(t){return t.name===e});return i.length?i[0]:(i={name:e,navName:e,list:[]},t.push(i),i)}}));i.exports=l},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@latest/js/modules/citylist/template.html",[],function(t,e,i){i.exports='<div class="city_list"><dl><dt>定位城市</dt><dd><a class="J_city J_geo_city" href="javascript:;">正在获取定位..</a></dd></dl><dl><dt>热门城市</dt><%hotList.forEach(function(city,i){%><dd <%=city.id==current?\'class="on"\':\'\'%>><a class="J_city" data-id="<%=city.id%>" data-name="<%=city.name%>" href="<%=city.url%>"><%=city.name%></a></dd><%});%></dl><%indexList.forEach(function(item,i){%><dl class="J_list"><dt class="close"><%=item.name%><i class="arr"></i></dt><%item.list.forEach(function(city){%><dd class="hide <%=city.id==current?\'on\':\'\'%>"><a class="J_city" data-id="<%=city.id%>" data-name="<%=city.name%>" href="<%=city.url%>"><%=city.name%></a></dd><%});%></dl><%});%></div><div class="height-box"></div>'},{asyncDeps:["iscroll@~5.0.9"]}),define("unit-m-weixin@latest/js/pages/citylist",["zepto-wepp@~1.1.0","underscore@~1.5.0","marionette@~1.4.0","../modules/citylist/controller","../modules/citylist/layout.html"],function(t,e){var i=(t("zepto-wepp"),t("underscore")),n=t("marionette"),s=t("../modules/citylist/controller"),l=n.Controller.extend({show:function(){ThisApp.openPage().then(function(e){e.initRegion({template:i.template(t("../modules/citylist/layout.html")),regions:{content:".J_list"}}),(new s).render(e.layout.content)})}});e.Controller=l},{asyncDeps:["iscroll@~5.0.9"]});